<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Thia & Nicole Laundry - Forgot Password</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<link rel="stylesheet" href="toast.css">
<style>
  :root{--bg:#f4f7fb;--card:#fff;--primary:#1766ff;--muted:#6b7280;}
  body{
    margin: 0;
    font-family: Inter, system-ui, Arial;
    background: url('https://images.unsplash.com/photo-1696546761269-a8f9d2b80512?fm=jpg&ixid=M3wxMjA3fDB8MHxwaG90by1yZWxhdGVkfDE4fHx8ZW58MHx8fHx8&ixlib=rb-4.1.0&q=60&w=3000') no-repeat center center/cover fixed;
    position: relative;
    overflow-x: hidden;
  }
  body::before {
    content: "";
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: linear-gradient(135deg, rgba(188, 200, 224, 0.4), rgba(0,0,0,0.3));
    z-index: 0;
  }
  .floating-bubble {
    position: absolute;
    border-radius: 50%;
    background: rgba(174, 200, 226, 0.416); /* soft blue */
    backdrop-filter: blur(10px);
    box-shadow: 0 0 25px rgba(31, 31, 31, 0.2);
    pointer-events: none;
    animation: floatBubble linear infinite alternate;
    z-index: 1;
  } 
    /* 15 bubbles, scattered & elegant */
    .bubble1  { width:120px; height:120px; top:10%; left:8%;   animation: floatBubble 8s ease-in-out infinite; }
    .bubble2  { width:200px; height:200px; bottom:25%; left:12%; animation: floatBubble 5s ease-in-out infinite 2s;}
    .bubble3  { width:90px;  height:90px;  top:5%;  left:75%;  animation: floatBubble 6s ease-in-out infinite 2s; }
    .bubble4  { width:150px; height:150px; bottom:20%; right:20%; animation: floatBubble 10s ease-in-out infinite 4s; }
    .bubble5  { width:180px; height:180px; bottom:2%; left:8%; animation: floatBubble 7s ease-in-out infinite 4s; }
    .bubble6  { width:100px; height:100px; top:50%; right:5%;   animation: floatBubble 9s ease-in-out infinite 3s; }
    .bubble7  { width:130px; height:130px; bottom:8%; right:8%; animation: floatBubble 3s ease-in-out infinite 3s; }
    .bubble8  { width:160px; height:160px; top:38%; left:55%; animation: floatBubble 3s ease-in-out infinite 3s; }
    .bubble9  { width:110px; height:110px; top:18%; left:20%; animation: floatBubble 5s ease-in-out infinite 3s; }
    .bubble10 { width:140px; height:140px; bottom:15%; left:65%; animation: floatBubble 2s ease-in-out infinite 2s; }
    .bubble11 { width:170px; height:170px; bottom:0%; right:60%; animation: floatBubble 3s ease-in-out infinite 1s; }
    .bubble12 { width:100px; height:100px; bottom:0%; left:25%; animation: floatBubble 8s ease-in-out infinite 4s; }
    .bubble13 { width:190px; height:190px; top:4%; right:5%; animation: floatBubble 6s ease-in-out infinite 2s; }
    .bubble14 { width:80px;  height:80px;  top:60%; left:30%; animation: floatBubble 5s ease-in-out infinite 5s; }
    .bubble15 { width:150px; height:150px; bottom:90%; right:45%; animation: floatBubble 3s ease-in-out infinite 2s; }
    @keyframes floatBubble {
        0%   { transform: translateY(0) translateX(0); opacity: 0.7; }
        50%  { transform: translateY(-40px) translateX(20px); opacity: 1; }
        100% { transform: translateY(0) translateX(0); opacity: 0.7; }
  }
  .app{max-width:420px;margin:30px auto;padding:15px; position: relative;z-index: 10; } 
  .card{background:var(--card);padding:18px;border-radius:12px;box-shadow:0 6px 18px rgba(15,23,42,0.06)} 
  h2{margin-top:0;margin-bottom:15px;color:#111}
  label{display: block; margin-bottom: 4px; font-size: 14px; color: #333;} /* Consistent label styling */
  input{width:100%;padding:9px;margin-top:0;border-radius:8px;border:1px solid #ddd;box-sizing: border-box;} /* Adjusted padding and removed margin-top */
  .btn{display:inline-block;margin-top:14px;padding:9px 14px;background:var(--primary);color:#fff;border:none;border-radius:8px;cursor:pointer;font-size:14px;} /* Adjusted margin and padding */
  .btn.alt{background:#eef2ff;color:var(--primary)}
  .hidden{display:none}
  .password-field-wrapper {
    position: relative;
  }
  .password-field-wrapper input {
    padding-right: 40px; /* Make space for the icon */
  }
  .password-field-wrapper .toggle-password {
    position: absolute;
    right: 10px;
    top: 50%; /* Center vertically relative to the input field */
    transform: translateY(calc(-50% + 2px)); /* Fine-tune vertical alignment */
    cursor: pointer;
    color: var(--muted);
    font-size: 16px;
  }
</style>
</head>
<body>
    <div class="floating-bubble bubble1"></div>
    <div class="floating-bubble bubble2"></div>
    <div class="floating-bubble bubble3"></div>
    <div class="floating-bubble bubble4"></div>
    <div class="floating-bubble bubble5"></div>
    <div class="floating-bubble bubble6"></div>
    <div class="floating-bubble bubble7"></div>
    <div class="floating-bubble bubble8"></div>
    <div class="floating-bubble bubble9"></div>
    <div class="floating-bubble bubble10"></div>
    <div class="floating-bubble bubble11"></div>
    <div class="floating-bubble bubble12"></div>
    <div class="floating-bubble bubble13"></div>
    <div class="floating-bubble bubble14"></div>
    <div class="floating-bubble bubble15"></div>
<div class="app">

  <!-- STEP 1: Enter Email -->
  <div id="step1" class="card">
    <h2>Forgot Password</h2>
    <label>Email</label>
    <input id="forgot-email" type="email" placeholder="email@example.com">
    <button class="btn" id="check-email">Next</button>
    <button class="btn alt" onclick="location.href='auth.html'">Back to Login</button>
  </div>

  <!-- STEP 2: Reset Password -->
  <div id="step2" class="card hidden">
    <h2>Reset Password</h2>
    <div class="small" style="margin-bottom: 10px;">for <span id="reset-email"></span></div>
    <label>New Password</label>
    <div class="password-field-wrapper">
      <input id="new-pass" type="password" placeholder="New password">
      <i class="toggle-password fas fa-eye"></i>
    </div>
    <button class="btn" id="save-pass">Save Password</button>
  </div>

</div>

<script src="toast.js"></script>
<script>
/* ---------- HELPERS ---------- */
const LS_USERS = 'tn_accounts_v2';
function getUsers(){return JSON.parse(localStorage.getItem(LS_USERS)||'[]');}
function saveUsers(arr){localStorage.setItem(LS_USERS,JSON.stringify(arr));}

// -------- PASSWORD TOGGLE --------
document.querySelectorAll('.toggle-password').forEach(icon => {
  icon.addEventListener('click', () => {
    const passwordInput = icon.previousElementSibling;
    if (passwordInput.type === 'password') {
      passwordInput.type = 'text';
      icon.classList.remove('fa-eye');
      icon.classList.add('fa-eye-slash');
    } else {
      passwordInput.type = 'password';
      icon.classList.remove('fa-eye-slash');
      icon.classList.add('fa-eye');
    }
  });
});

/* ---------- STEP 1 ---------- */
document.getElementById('check-email').onclick = ()=>{
  const email = document.getElementById('forgot-email').value.trim();
  if(!email){showToast('Enter your email', 'error');return;}
  const users = getUsers();
  const u = users.find(x=>x.email===email);
  if(!u){showToast('No account found with this email', 'error');return;}
  // proceed to step 2
  document.getElementById('reset-email').textContent = email;
  document.getElementById('step1').classList.add('hidden');
  document.getElementById('step2').classList.remove('hidden');
};

/* ---------- STEP 2 ---------- */
document.getElementById('save-pass').onclick = ()=>{
  const email = document.getElementById('reset-email').textContent;
  const pass = document.getElementById('new-pass').value.trim();
  if(!pass){showToast('Enter a new password', 'error');return;}

  const pwPattern = /^(?=.*[a-z])(?=.*[A-Z])(?=.*[^A-Za-z0-9]).{8,15}$/;
  if(!pwPattern.test(pass)){
    showToast('Password must be 8-15 chars with upper, lower & special characters', 'error');
    return;
  }

  const users = getUsers();
  const idx = users.findIndex(u=>u.email===email);
  if(idx===-1){showToast('User not found', 'error');return;}
  users[idx].password = btoa(pass); // Encode password
  saveUsers(users);
  showToast('Password updated successfully!', 'success');
  location.href='auth.html';
};
</script>
</body>
</html>